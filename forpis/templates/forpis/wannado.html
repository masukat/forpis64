{% load static %}
<!doctype html>
<html lang="ja">
<head>
    <meta charset="utf-8">
    <title>forpis</title>
    <link rel="stylesheet" type="text/css" href="{% static 'forpis/css/dateplan.css' %}" />
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.1/css/all.css" />
    <link rel="shortcut icon" type="image/x-icon" href="{% static 'forpis/image/forpis/masukat_favicon.ico' %}" />
    <link rel="apple-touch-icon" href="{% static 'forpis/image/forpis/masukat_icon_2.png' %}" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
    <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <script>
        $( function() {
            // 日付は、年-月-日 の形式でお願いする。
            let dateFormat = 'yy-mm-dd';
            $('#id_completiondate').datepicker({
            dateFormat: dateFormat
            });
        } );
    </script>
</head>
<body>
  <script>
      window.onload = function(){
          //もしスマホなら最初は非表示
          if(navigator.userAgent.match(/(iPhone|iPod|Android.*Mobile)/i)){
              hidden();
              hourHidden();
              minHidden();
              hourHidden2();
              minHidden2();
          }else{
              AllChecked();
          }
          //自動補完をoff
          $('form').attr('autocomplete', 'off');
      }
      function AllChecked(){
          document.querySelectorAll('.checkbox input').forEach(function(input){
              input.checked = true;
          });
      }
      //最初に隠しておくため
      function hidden(){
          var array = ["delete_1","edit_1","genre1_1","tag1_1","delete_2","edit_2","genre1_2","tag1_2","completiondate_2"];
              for(var j=0;j<array.length;j++){
                  var id = array[j] + "_display";
                  var obj = array[j] + "_check";
                  var CELL = document.getElementById(id);
                  var TABLE = CELL.parentNode.parentNode.parentNode;
                  for(var i=0;TABLE.rows[i];i++) {
                      TABLE.rows[i].cells[CELL.cellIndex].style.display = (document.getElementById(obj).checked) ? '' : 'none';
                  }
              }
      }
      function hourHidden(){
          var c = document.getElementById("hour_1_display");
          var t = c.parentNode.parentNode.parentNode;
          for(var i=0;t.rows[i];i++) {
              t.rows[i].cells[c.cellIndex].style.display = "none";
          }
      }
      function minHidden(){
          var c = document.getElementById("min_1_display");
          var t = c.parentNode.parentNode.parentNode;
          for(var i=0;t.rows[i];i++) {
              t.rows[i].cells[c.cellIndex].style.display = "none";
          }
      }
      function hourHidden2(){
          var c = document.getElementById("hour_2_display");
          var t = c.parentNode.parentNode.parentNode;
          for(var i=0;t.rows[i];i++) {
              t.rows[i].cells[c.cellIndex].style.display = "none";
          }
      }
      function minHidden2(){
          var c = document.getElementById("min_2_display");
          var t = c.parentNode.parentNode.parentNode;
          for(var i=0;t.rows[i];i++) {
              t.rows[i].cells[c.cellIndex].style.display = "none";
          }
      }
      //checkboxのcheckがついたら表示
      function checkbox_cell( obj,id ){
          var CELL = document.getElementById(id);
          var TABLE = CELL.parentNode.parentNode.parentNode;
          for(var i=0;TABLE.rows[i];i++) {
              TABLE.rows[i].cells[CELL.cellIndex].style.display = (obj.checked) ? '' : 'none';
          }
      }
      function checkbox_cell_2( obj,id ){
          var CELL = document.getElementById(id);
          var TABLE = CELL.parentNode.parentNode.parentNode;
          for(var i=0;TABLE.rows[i];i++) {
              TABLE.rows[i].cells[CELL.cellIndex].style.display = (obj.checked) ? '' : 'none';
          }
      }
  </script>
  <div class="headerImg"><img src="{% static 'forpis/image/forpis/画像1.png' %}" alt="title" class="titleImg"></div>
  <h1>Let's just DO it!</h1>

  <!-- 追加・更新画面 -->
  {% if delete_flag == 0 %}
      {% if id == 0 %}
          <div class="iventName"><i class="fas fa-paw"></i>追加</div>
          <form action="{% url 'wannado' %}" method="post">
      {% elif id > 0 %}
          <div><a href={% url 'wannado' %}><button class="return_button" type="button"><i class="fas fa-arrow-circle-left"></i> 追加画面へ戻る</button></a></div>
          <div class="iventName"><i class="fas fa-paw"></i>更新</div>
          <form action="{% url 'wannado_edit' id %}" method="post">
      {% endif %}
          <!-- 完了確認欄 -->
          <div class="add-table_done">
              <div class="done_tr">
                  <div class="done_th" width="60px">完了</div>
                  <div class="done_td">{{form.done}}</div>
              </div>
              <div class="done_tr">
                  <div class="done_th">評価</div>
                  <div class="done_td">{{form.review}}</div>
              </div>
              <div class="done_tr">
                  <div class="done_th_completiondate">完了日</div>
                  <div class="done_td">{{form.completiondate}}</div>
              </div>
          </div>
          <!-- 追加・更新欄 -->
          <div class="add-table">
              <div class="add-table_1">
                  <div class="tr">
                      <div class="th_motivation"><i class="fas fa-child"></i></div>
                      <div class="td_id_motivation">{{form.motivation}}</div>
                  </div>
                  <div class="tr">
                      <div class="th_genre1">in/out</div>
                      <div class="td_id_genre1">{{form.genre1}}</div>
                  </div>
                  <div class="tr">
                      <div class="th_genre2">項目</div>
                      <div class="td_id_genre2">{{form.genre2}}</div>
                  </div>
              </div>
              <div class="add-table_2">
                <div class="tr">
                    <div class="th_plan">やりたいこと(場所:案)</div>
                    <div class="td_id_plan">{{form.plan}}</div>
                </div>
                <div class="tr">
                    <div class="th_travelhour">h</div>
                    <div class="td_id_travelhour">{{form.travelhour}}</div>
                </div>
                <div class="tr">
                    <div class="th_travelmin">min</div>
                    <div class="td_id_travelmin">{{form.travelmin}}</div>
                </div>
              </div>
              <div class="add-table_3">
                  <div class="tr">
                      <div class="th_urllink">URL</div>
                      <div class="td_id_urllink">{{form.urllink}}</div>
                  </div>
                  <div class="tr">
                      <div class="th_tag1">メモ</div>
                      <div class="td_id_tag1">{{form.tag1}}</div>
                  </div>
              </div>
              <div class="add-table_input">
                  <div class="tr_input">
                      <input class="tr_input" type="submit" value={% if id == 0 %}"追加！"{% else %}"更新！"{% endif %}>
                  </div>
              </div>
          </div>
              {% csrf_token %}
          </form>

  <!-- 削除画面(データ表示) -->
  {% elif delete_flag == 1 %}
          <div><a href={% url 'wannado' %}><button class="return_button" type="button"><i class="fas fa-arrow-circle-left"></i> 消さない</button></a></div>
          <div class="iventName"><i class="fas fa-paw"></i>消す？？</div>
          <form action={% url 'wannado_delete' id%} method="post">

          <!-- 完了確認欄 -->
          <div class="delete-table_done">
              <div class="done_tr">
                  <div class="done_th_delete" width="60px">完了</div>
                  <div class="done_td_delete">{% if obj.done %}完了{% else %}未完了{% endif %}</div>
              </div>
              <div class="done_tr">
                  <div class="done_th_delete">評価</div>
                  <div class="done_td_delete">{% if obj.review is None %}ー{% else %}{{obj.review}}{% endif %}</div>
              </div>
              <div class="done_tr">
                  <div class="done_th_delete_completiondate">完了日</div>
                  <div class="done_td_delete">{% if obj.completiondate is None %}ー{% else %}{{obj.completiondate|date:"Y/n/j"}}{% endif %}</div>
              </div>
          </div>
          <!-- 追加・更新欄 -->
          <div class="delete-table">
              <div class="delete-table_1">
                  <div class="tr">
                      <div class="delete_th_motivation"><i class="fas fa-child"></i></div>
                      <div class="td_id_motivation">{% if obj.motivation is None %}ー{% else %}{{obj.motivation}}{% endif %}</div>
                  </div>
                  <div class="tr">
                      <div class="delete_th_genre1">in/out</div>
                      <div class="td_id_genre1">{{obj.genre1}}</div>
                  </div>
                  <div class="tr">
                      <div class="delete_th_genre2">項目</div>
                      <div class="td_id_genre2">{{obj.genre2}}</div>
                  </div>
              </div>
              <div class="delete-table_2">
                  <div class="tr">
                      <div class="delete_th_plan">やりたいこと(場所:案)</div>
                      <div class="td_id_plan">{{obj.plan}}</div>
                  </div>
                  <div class="tr">
                      <div class="delete_th_travelhour">h</div>
                      <div class="td_id_travelhour">{% if obj.travelhour is None %}ー{% else %}{{obj.travelhour}}{% endif %}</div>
                  </div>
                  <div class="tr">
                      <div class="delete_th_travelmin">min</div>
                      <div class="td_id_travelmin">{% if obj.travelmin is None %}ー{% else %}{{obj.travelmin}}{% endif %}</div>
                  </div>
              </div>
              <div class="delete-table_3">
                  <div class="tr">
                      <div class="delete_th_urllink">URL</div>
                      <div class="td_id_urllink">{% if obj.urllink == '' %}ー
                                                  {% else %}<a href = {{obj.urllink}} target="_blank">{{obj.urllink}}</a>
                                                  {% endif %}</div>
                  </div>
                  <div class="tr">
                      <div class="delete_th_tag1">メモ</div>
                      <div class="td_id_tag1">{% if obj.tag1 == '' %}ー{% else %}{{obj.tag1}}{% endif %}</div>
                  </div>
              </div>
              <div class="delete-table_input">
                  <div class="tr_input_delete">
                      <input type="submit" value="削除">
                  </div>
              </div>
          </div>
              {% csrf_token %}
          </form>
  {% endif %}

  <!-- やりたいことリスト -->
  <div class="iventName"><i class="fas fa-paw"></i>やりたいことリスト</div>
      <!-- 初期状態で列非表示 -->
      <div class="checkbox">
          <div class="delete_edit_check">
              編集する？
              <input type="checkbox" id="delete_1_check" onclick="checkbox_cell(this,'delete_1_display')">delete
              <input type="checkbox" id="edit_1_check" onclick="checkbox_cell(this,'edit_1_display')">edit
          </div>
          <div class="genre1_time_tag1_check">
              他項目:
              <input type="checkbox" id="genre1_1_check" onclick="checkbox_cell(this,'genre1_1_display')">in/out
              <input type="checkbox" id="tag1_1_check" onclick="checkbox_cell(this,'tag1_1_display')">memo
              <input type="checkbox" id="time_1_check" onclick="checkbox_cell(this,'hour_1_display');checkbox_cell_2(this,'min_1_display')">時間
          </div>
      </div>
      <!-- テーブル(idは非表示にするときに呼び出される) -->
      <div class="edit-table_undone" align="center">
          <table>
              <thead class="edit-table_thead_undone">
                  <tr>
                      <th id="delete_1_display">削除</th>
                      <th id="edit_1_display">編集</th>
                      <th id="motivation_1_display"><i class="fas fa-child"></th>
                      <th id="genre1_1_display">in/<br>out</th>
                      <th id="genre2_1_display">項目</th>
                      <th id="plan_1_display">やりたいこと(場所:案)</th>
                      <th id="hour_1_display">h</th>
                      <th id="min_1_display">min</th>
                      <th id="tag1_1_display">メモ</th>
                  </tr>
              </thead>
              <tbody class="edit-table_tbody_undone">
              {% for plan in data_undone %}
                  {% if plan.done == False %}
                  <tr class="undonerow">
                    <td class="delete"><a href={% url 'wannado_delete' plan.id%}><i class="far fa-trash-alt"></i></a></td>
                     <td class="edit"><a href={% url 'wannado_edit' plan.id %}><i class="far fa-edit"></i></a></td>
                      <td class="motivation">{% if plan.motivation is None %}ー{% else %}{{plan.motivation}}{% endif %}</td>
                      <td class="genre1">{{plan.genre1}}</td>
                      <td class="genre2">{{plan.genre2}}</td>
                      <td class="plan">
                                        {% if plan.urllink == '                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ' %}
                                          {{plan.plan}}
                                        {%  else %}
                                          <a href="{{plan.urllink}}" target="_blank">{{plan.plan}}</a>
                                        {% endif %}
                      </td>
                      <td class="travelhour">{% if plan.travelhour is None %}ー{% else %}{{plan.travelhour}}{% endif %}</td>
                      <td class="travelmin">{% if plan.travelmin is None %}ー{% else %}{{plan.travelmin}}{% endif %}</td>
                      <td class="tag">
                                      {% if plan.tag1 == '                                                                                                    ' %}
                                      {% else %}
                                        {{plan.tag1}}
                                      {% endif %}
                      </td>
                  </tr>
                  {% endif %}
              {% endfor %}
              </tbody>
          </table>
      </div>

  <!-- やったことリスト -->
  <div class="iventName"><i class="fas fa-paw"></i>やったことリスト</div>
      <!-- 初期状態で列非表示 -->
      <div class="checkbox">
          <div class="delete_edit_check_done">
              編集する？
              <input type="checkbox" id="delete_2_check" onclick="checkbox_cell(this,'delete_2_display')">delete
              <input type="checkbox" id="edit_2_check" onclick="checkbox_cell(this,'edit_2_display')">edit
          </div>
          <div class="genre1_time_tag1_check">
              他項目:
              <input type="checkbox" id="completiondate_2_check" onclick="checkbox_cell(this,'completiondate_2_display')">完了日
              <input type="checkbox" id="genre1_2_check" onclick="checkbox_cell(this,'genre1_2_display')">in/out
              <input type="checkbox" id="tag1_2_check" onclick="checkbox_cell(this,'tag1_2_display')">memo
              <input type="checkbox" id="time_2_check" onclick="checkbox_cell(this,'hour_2_display');checkbox_cell_2(this,'min_2_display')">時間
          </div>
      </div>
      <!-- テーブル(idは非表示にするときに呼び出される) -->
      <div class="edit-table_done" align="center">
          <table>
              <thead class="edit-table_thead_done">
                  <tr>
                      <th id="delete_2_display">削除</th>
                      <th id="edit_2_display">編集</th>
                      <th id="review_2_display">評価</th>
                      <th id="genre1_2_display">in/<br>out</th>
                      <th id="genre2_2_display">項目</th>
                      <th id="plan_2_display">やりたいこと(場所:案)</th>
                      <th id="hour_2_display">h</th>
                      <th id="min_2_display">min</th>
                      <th id="tag1_2_display">メモ</th>
                      <th id="completiondate_2_display">完了日</th>
                  </tr>
              </thead>
              <tbody class="edit-table_tbody_done">
              {% for plan in data_done %}
                  {% if plan.done %}
                  <tr class="donerow">
                      <td class="delete"><a href={% url 'wannado_delete' plan.id%}><i class="fas fa-trash-alt"></i></a></td>
                      <td class="edit"><a href={% url 'wannado_edit' plan.id %}><i class="fas fa-edit"></i></a></td>
                      <td class="review">{% if plan.review is None %}ー{% else %}{{plan.review}}{% endif %}</td>
                      <td class="genre1">{{plan.genre1}}</td>
                      <td class="genre2">{{plan.genre2}}</td>
                      <td class="plan">
                                        {% if plan.urllink == '                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ' %}
                                          {{plan.plan}}
                                        {%  else %}
                                          <a href="{{plan.urllink}}">{{plan.plan}}</a>
                                        {% endif %}
                      </td>
                      <td class="travelhour">{% if plan.travelhour is None %}ー{% else %}{{plan.travelhour}}{% endif %}</td>
                      <td class="travelmin">{% if plan.travelmin is None %}ー{% else %}{{plan.travelmin}}{% endif %}</td>
                      <td class="tag">
                                      {% if plan.tag1 == '                                                                                                    ' %}
                                      {% else %}
                                        {{plan.tag1}}
                                      {% endif %}
                      </td>
                      <td class="completiondate">{% if plan.completiondate is None %}ー{% else %}{{plan.completiondate|date:"Y/m/d"}}{% endif %}</td>
                  </tr>
                  {% endif %}
              {% endfor %}
              </tbody>
          </table>
      </div>
</body>
